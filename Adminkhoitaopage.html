<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Qu·∫£n Tr·ªã Vi√™n</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * { box-sizing: border-box; margin:0; padding:0; }
    body {
      font-family: Arial, sans-serif;
      background-color: #f3f4f6;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h2 { color: #333; margin-bottom: 16px; text-align: center; }
    .container {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      width: 100%;
      max-width: 500px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    label { font-weight: bold; }
    input[type="text"], textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 14px;
    }
    textarea { resize: none; min-height: 80px; }
    button {
      width: 100%;
      padding: 12px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover { background-color: #0056b3; }
    .popup {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
    }
    .popup-content {
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      width: 90%;
      max-width: 350px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      text-align: center;
    }
    .popup input {
      width: 100%;
      padding: 8px;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin-top: 10px;
    }
    .popup-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 15px;
      gap: 8px;
    }
    .popup-buttons button {
      flex: 1;
      padding: 10px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
    }
    .confirm { background-color: #28a745; color: white; }
    .confirm:hover { background-color: #218838; }
    .cancel { background-color: #dc3545; color: white; }
    .cancel:hover { background-color: #c82333; }
    .error {
      animation: blink 0.4s linear 2;
      border-color: red !important;
    }
    @keyframes blink {
      0%, 100% { background-color: white; }
      50% { background-color: #ffe6e6; }
    }
  </style>
</head>
<body>
  <h2>Qu·∫£n Tr·ªã Vi√™n Kh·ªüi T·∫°o</h2>
  <div class="container">
    <label for="a">Ti√™u ƒë·ªÅ b√†i vi·∫øt:</label>
    <input type="text" id="a" placeholder="VD: Tai n·∫°n giao th√¥ng t·∫°i ƒê·ªÅ Gi">

    <label for="ab">N·ªôi dung chi ti·∫øt:</label>
    <textarea id="ab" placeholder="M√¥ t·∫£ chi ti·∫øt s·ª± vi·ªác..."></textarea>

    <label for="b">Link Google Drive video (chia s·∫ª):</label>
    <input type="text" id="b" placeholder="D√°n link chia s·∫ª t·ª´ Google Drive">

    <label for="c">Link ·∫£nh qu·∫£ng c√°o:</label>
    <input list="videoAds" type="text" id="c" placeholder="Ch·ªçn ho·∫∑c nh·∫≠p link ·∫£nh">
    <datalist id="videoAds">
      <option value="https://tintucmxh.github.io/TinTucMXH/vn-11134258-820l4-mgug0poszr4b79.webp">Shopee Banner</option>
      <option value="https://tintucmxh.github.io/TinTucMXH/mbhtrungquyen.webp">M≈© B·∫£o Hi·ªÉm</option>
    </datalist>

    <label for="d">Link chuy·ªÉn h∆∞·ªõng khi nh·∫•n qu·∫£ng c√°o:</label>
    <input list="Ads" type="text" id="d" placeholder="Link Shopee, Tiki...()">
    <datalist id="Ads">
      <option value="https://s.shopee.vn/an_redir?origin_link=https%3A%2F%2Fshopee.vn%2Fproduct%2F642872908%2F26564042129...">Link 1</option>
      <option value="https://s.shopee.vn/an_redir?origin_link=https%3A%2F%2Fshopee.vn%2Fproduct%2F1597381587%2F42120625683...">Link 2</option>
    </datalist>

    <button onclick="xuatDuLieu()">Xu·∫•t d·ªØ li·ªáu</button>
    <button onclick="hienPopup()">L∆∞u file</button>
    <button onclick="xemTruoc()">Xem tr∆∞·ªõc</button>

    <label>Th√¥ng tin:</label>
    <textarea id="outputtt" readonly placeholder="Th√¥ng tin s·∫Ω hi·ªán ·ªü ƒë√¢y..."></textarea>

    <label>K·∫øt qu·∫£ HTML:</label>
    <textarea id="output" readonly placeholder="File HTML s·∫Ω hi·ªán ·ªü ƒë√¢y..."></textarea>

    <label>ƒê∆∞·ªùng d·∫´n trang:</label>
    <input type="text" id="linktrangwes" readonly placeholder="S·∫Ω hi·ªán sau khi l∆∞u">
  </div>

  <!-- Popup l∆∞u file -->
  <div class="popup" id="popup">
    <div class="popup-content">
      <h3>Nh·∫≠p t√™n file</h3>
      <input type="text" id="fileName" placeholder="T√™n file (kh√¥ng .html)">
      <div class="popup-buttons">
        <button class="confirm" onclick="xacNhanLuu()">X√°c nh·∫≠n</button>
        <button class="cancel" onclick="dongPopup()">H·ªßy</button>
      </div>
    </div>
  </div>

  <script>
    // H√†m chuy·ªÉn Google Drive link sang preview
    function convertDriveLink(url) {
      const match = url.match(/\/d\/([a-zA-Z0-9-_]+)/);
      return match ? `https://drive.google.com/file/d/${match[1]}/preview` : url;
    }

    // T·∫°o file HTML b·∫±ng m·∫£ng + join() ‚Üí AN TO√ÄN 100%
    function taoFileHTML(tieude, noidung, videoUrl, adImg, adLink) {
      const videoSrc = convertDriveLink(videoUrl);

      const html = [
        '<!DOCTYPE html>',
        '<html lang="vi">',
        '<head>',
        '  <meta charset="UTF-8">',
        '  <title>üì∞ Tin T·ª©c MXH</title>',
        '  <meta name="viewport" content="width=device-width, initial-scale=1.0">',
        '  <style>',
        '    * { box-sizing: border-box; margin: 0; padding: 0; }',
        '    body { font-family: Arial, sans-serif; background: #f5f6f7; }',
        '    header { background: #222; color: #fff; padding: 12px 18px; }',
        '    nav a { color: #fff; margin-right: 12px; text-decoration: none; font-weight: bold; }',
        '    main { max-width: 900px; margin: 20px auto; padding: 0 16px; }',
        '    article { background: #fff; padding: 16px; border-radius: 6px; box-shadow: 0 2px 6px rgba(0,0,0,0.08); margin-bottom: 20px; }',
        '    footer { text-align: center; padding: 12px; background: #222; color: #fff; margin-top: 18px; }',
        '    .video-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 8px; margin-top: 12px; background: #000; }',
        '    .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }',
        '    .gallery { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 10px; margin-top: 12px; }',
        '    .gallery img { width: 100%; height: 100px; object-fit: cover; border-radius: 6px; cursor: pointer; transition: transform 0.2s; box-shadow: 0 1px 4px rgba(0,0,0,0.2); }',
        '    .gallery img:hover { transform: scale(1.05); }',
        '    .lightbox { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 10000; justify-content: center; align-items: center; padding: 20px; }',
        '    .lightbox img { max-width: 90%; max-height: 90%; border-radius: 8px; box-shadow: 0 0 20px rgba(255,255,255,0.3); }',
        '    .lightbox.active { display: flex; }',
        '    .popup { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 320px; background: #fff; box-shadow: 0 4px 20px rgba(0,0,0,0.3); border-radius: 10px; text-align: center; z-index: 9999; padding: 16px; display: none; animation: fadeIn 0.6s ease; }',
        '    @keyframes fadeIn { from { opacity: 0; transform: translate(-50%, -55%); } to { opacity: 1; transform: translate(-50%, -50%); } }',
        '    .popup h3 { margin: 0 0 8px; color: #222; }',
        '    .popup p { color: #555; font-size: 14px; margin-bottom: 10px; }',
        '    .popup img { width: 100%; border-radius: 8px; cursor: pointer; }',
        '    .close-btn { position: absolute; top: 6px; right: 10px; background: #f44336; color: #fff; border: none; border-radius: 50%; width: 24px; height: 24px; cursor: pointer; font-weight: bold; line-height: 22px; }',
        '  </style>',
        '</head>',
        '<body>',
        '  <header>',
        '    <h1>Tin T·ª©c M·∫°ng X√£ H·ªôi</h1>',
        '    <nav>',
        '      <a href="index.html">Trang ch·ªß</a>',
        '      <a href="news.html">Tin t·ª©c</a>',
        '      <a href="about.html">Gi·ªõi thi·ªáu</a>',
        '    </nav>',
        '  </header>',
        '  <main>',
        '    <article>',
        '      <h2>' + tieude + '</h2>',
        '      <p>' + noidung.replace(/\n/g, '<br>') + '</p>',
        '      <div class="video-container">',
        '        <iframe src="' + videoSrc + '" allow="autoplay; encrypted-media" allowfullscreen></iframe>',
        '      </div>',
        '      <div id="mediaContainer"></div>',
        '    </article>',
        '  </main>',
        '  <footer>¬© 2025 Tin T·ª©c 24h</footer>',
        '  <div class="lightbox" id="lightbox"><img id="lightboxImg" src="" alt="·∫¢nh l·ªõn"></div>',
        '  <div class="popup" id="adPopup">',
        '    <button class="close-btn" id="closePopup">√ó</button>',
        '    <h3>Khuy·∫øn m√£i ƒë·∫∑c bi·ªát!</h3>',
        '    <p>Nh·∫•n v√†o ·∫£nh ƒë·ªÉ xem chi ti·∫øt ∆∞u ƒë√£i.</p>',
        '    <img id="adImage" src="' + adImg + '" alt="Qu·∫£ng c√°o">',
        '  </div>',
        '  <script>',
        '    const adLink = "' + adLink + '";',
        '    const mediaItems = [',
        '      { type: "video", src: "' + videoSrc + '" },',
        '      { type: "image", src: "https://tintucmxh.github.io/TinTucMXH/anh1.jpg" },',
        '      { type: "image", src: "https://tintucmxh.github.io/TinTucMXH/anh2.jpg" }',
        '    ];',
        '    window.onload = function() {',
        '      const container = document.getElementById("mediaContainer");',
        '      const lightbox = document.getElementById("lightbox");',
        '      const lightboxImg = document.getElementById("lightboxImg");',
        '      const popup = document.getElementById("adPopup");',
        '      const adImage = document.getElementById("adImage");',
        '      const closePopup = document.getElementById("closePopup");',
        '      mediaItems.forEach((item, i) => {',
        '        if (item.type === "video") {',
        '          const div = document.createElement("div"); div.className = "video-container";',
        '          div.innerHTML = `<iframe src="${item.src}" allow="autoplay; encrypted-media" allowfullscreen></iframe>`;',
        '          container.appendChild(div);',
        '        } else if (item.type === "image") {',
        '          if (!document.querySelector(".gallery")) {',
        '            const g = document.createElement("div"); g.className = "gallery"; container.appendChild(g);',
        '          }',
        '          const gallery = document.querySelector(".gallery");',
        '          const img = document.createElement("img");',
        '          img.src = item.src; img.alt = `·∫¢nh ${i}`;',
        '          img.onclick = () => { lightboxImg.src = item.src; lightbox.classList.add("active"); };',
        '          gallery.appendChild(img);',
        '        }',
        '      });',
        '      lightbox.onclick = () => lightbox.classList.remove("active");',
        '      adImage.src = "' + adImg + '";',
        '      adImage.onclick = () => { window.open(adLink, "_blank"); hidePopup(); };',
        '      closePopup.onclick = hidePopup;',
        '      let t; function showPopup() { popup.style.display = "block"; t = setTimeout(() => { window.open(adLink, "_blank"); hidePopup(); }, 5000); }',
        '      function hidePopup() { clearTimeout(t); popup.style.display = "none"; setTimeout(showPopup, 30000); }',
        '      setTimeout(showPopup, 2000);',
        '    };',
        '  <\/script>',
        '</body>',
        '</html>'
      ];

      return html.join('\n');
    }

    function xuatDuLieu() {
      const a = document.getElementById("a").value.trim();
      const ab = document.getElementById("ab").value.trim();
      const b = document.getElementById("b").value.trim();
      const c = document.getElementById("c").value.trim();
      const d = document.getElementById("d").value.trim();

      if (!a || !ab || !b) {
        alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß ti√™u ƒë·ªÅ, n·ªôi dung, v√† link video!");
        return;
      }

      const html = taoFileHTML(a, ab, b, c, d);
      const info = `Ti√™u ƒë·ªÅ: ${a}\nN·ªôi dung: ${ab}\nVideo: ${convertDriveLink(b)}\nQC: ${c}\nLink: ${d}`;

      document.getElementById("output").value = html;
      document.getElementById("outputtt").value = info;
    }

    function hienPopup() {
      document.getElementById("popup").style.display = "flex";
    }

    function dongPopup() {
      document.getElementById("popup").style.display = "none";
      document.getElementById("fileName").value = "";
    }

    function xemTruoc() {
      xuatDuLieu();
      const html = document.getElementById("output").value;
      const blob = new Blob([html], { type: "text/html" });
      window.open(URL.createObjectURL(blob), "_blank");
    }

    function xacNhanLuu() {
      const ten = document.getElementById("fileName").value.trim();
      if (!ten) {
        const input = document.getElementById("fileName");
        input.classList.add("error");
        setTimeout(() => input.classList.remove("error"), 800);
        return;
      }

      xuatDuLieu();
      const noidung = document.getElementById("output").value;
      const blob = new Blob([noidung], { type: "text/html;charset=utf-8" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = ten + ".html";
      link.click();

      document.getElementById("linktrangwes").value = 
        "https://tintucmxh.github.io/TinTucMXH/" + ten + ".html";

      dongPopup();
    }
  </script>
</body>
</html>
